I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally
I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: GeForce GTX 1070
major: 6 minor: 1 memoryClockRate (GHz) 1.645
pciBusID 0000:01:00.0
Total memory: 7.92GiB
Free memory: 7.46GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1070, pci bus id: 0000:01:00.0)
WARNING:tensorflow:Standard services need a 'logdir' passed to the SessionManager
[<tf.Tensor 'Train/Model/RNN/MultiRNNCell/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_1/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_2/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_3/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_4/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_5/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_6/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_7/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_8/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_9/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_10/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_11/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_12/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_13/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_14/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_15/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_16/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_17/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_18/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Train/Model/RNN/MultiRNNCell_19/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>]
[20]
[20]
[<tf.Tensor 'Train/Model/add:0' shape=(400, 10000) dtype=float32>]
[<tf.Tensor 'Train/Model/Reshape_1:0' shape=(400,) dtype=int32>]
[<tf.Tensor 'Train/Model/ones:0' shape=(400,) dtype=float32>]
[<tf.Tensor 'Valid/Model/RNN/MultiRNNCell/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_1/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_2/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_3/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_4/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_5/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_6/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_7/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_8/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_9/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_10/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_11/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_12/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_13/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_14/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_15/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_16/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_17/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_18/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>, <tf.Tensor 'Valid/Model/RNN/MultiRNNCell_19/Cell1/BasicLSTMCell/mul_2:0' shape=(20, 200) dtype=float32>]
[20]
[20]
[<tf.Tensor 'Valid/Model/add:0' shape=(400, 10000) dtype=float32>]
[<tf.Tensor 'Valid/Model/Reshape_1:0' shape=(400,) dtype=int32>]
[<tf.Tensor 'Valid/Model/ones:0' shape=(400,) dtype=float32>]
[<tf.Tensor 'Test/Model/RNN/MultiRNNCell/Cell1/BasicLSTMCell/mul_2:0' shape=(1, 200) dtype=float32>]
[1]
[1]
[<tf.Tensor 'Test/Model/add:0' shape=(1, 10000) dtype=float32>]
[<tf.Tensor 'Test/Model/Reshape_1:0' shape=(1,) dtype=int32>]
[<tf.Tensor 'Test/Model/ones:0' shape=(1,) dtype=float32>]
Epoch: 1 Learning rate: 1.000
0.004 perplexity: 6240.529 speed: 2052 wps
0.104 perplexity: 846.031 speed: 17321 wps
0.204 perplexity: 625.299 speed: 20849 wps
0.304 perplexity: 505.827 speed: 22343 wps
0.404 perplexity: 436.240 speed: 23334 wps
0.504 perplexity: 390.885 speed: 23974 wps
0.604 perplexity: 351.968 speed: 24463 wps
0.703 perplexity: 325.073 speed: 24716 wps
0.803 perplexity: 303.892 speed: 24953 wps
0.903 perplexity: 284.375 speed: 25145 wps
Epoch: 1 Train Perplexity: 269.758
Epoch: 1 Valid Perplexity: 177.993
Epoch: 2 Learning rate: 1.000
0.004 perplexity: 209.200 speed: 26663 wps
0.104 perplexity: 150.951 speed: 26645 wps
0.204 perplexity: 158.209 speed: 26248 wps
0.304 perplexity: 153.083 speed: 25846 wps
0.404 perplexity: 150.214 speed: 26026 wps
0.504 perplexity: 147.848 speed: 26171 wps
0.604 perplexity: 143.238 speed: 26197 wps
0.703 perplexity: 141.144 speed: 26320 wps
0.803 perplexity: 139.234 speed: 26366 wps
0.903 perplexity: 135.607 speed: 26410 wps
Epoch: 2 Train Perplexity: 133.488
Epoch: 2 Valid Perplexity: 142.526
Epoch: 3 Learning rate: 1.000
0.004 perplexity: 146.144 speed: 26720 wps
0.104 perplexity: 105.255 speed: 26068 wps
0.204 perplexity: 114.520 speed: 26375 wps
0.304 perplexity: 111.659 speed: 26448 wps
0.404 perplexity: 110.676 speed: 26652 wps
0.504 perplexity: 109.765 speed: 26614 wps
0.604 perplexity: 107.103 speed: 26362 wps
0.703 perplexity: 106.492 speed: 26365 wps
0.803 perplexity: 105.866 speed: 26341 wps
0.903 perplexity: 103.578 speed: 26231 wps
Epoch: 3 Train Perplexity: 102.598
Epoch: 3 Valid Perplexity: 132.751
Epoch: 4 Learning rate: 1.000
0.004 perplexity: 115.307 speed: 23634 wps
0.104 perplexity: 85.133 speed: 26569 wps
0.204 perplexity: 93.565 speed: 26937 wps
0.304 perplexity: 91.401 speed: 26904 wps
0.404 perplexity: 90.864 speed: 26905 wps
0.504 perplexity: 90.469 speed: 26943 wps
0.604 perplexity: 88.641 speed: 26777 wps
0.703 perplexity: 88.412 speed: 26768 wps
0.803 perplexity: 88.198 speed: 26834 wps
0.903 perplexity: 86.578 speed: 26905 wps
Epoch: 4 Train Perplexity: 86.027
Epoch: 4 Valid Perplexity: 127.668
Epoch: 5 Learning rate: 0.500
0.004 perplexity: 97.835 speed: 27853 wps
0.104 perplexity: 71.031 speed: 26853 wps
0.204 perplexity: 76.997 speed: 27058 wps
0.304 perplexity: 74.252 speed: 27159 wps
0.404 perplexity: 73.170 speed: 27185 wps
0.504 perplexity: 72.212 speed: 27123 wps
0.604 perplexity: 70.123 speed: 27121 wps
0.703 perplexity: 69.390 speed: 27093 wps
0.803 perplexity: 68.631 speed: 27067 wps
0.903 perplexity: 66.731 speed: 27086 wps
Epoch: 5 Train Perplexity: 65.714
Epoch: 5 Valid Perplexity: 118.012
Epoch: 6 Learning rate: 0.250
0.004 perplexity: 80.479 speed: 27766 wps
0.104 perplexity: 58.452 speed: 26762 wps
0.204 perplexity: 63.613 speed: 26870 wps
0.304 perplexity: 61.315 speed: 26839 wps
0.404 perplexity: 60.362 speed: 26726 wps
0.504 perplexity: 59.467 speed: 26553 wps
0.604 perplexity: 57.619 speed: 26390 wps
0.703 perplexity: 56.924 speed: 26218 wps
0.803 perplexity: 56.179 speed: 26254 wps
0.903 perplexity: 54.467 speed: 26246 wps
Epoch: 6 Train Perplexity: 53.483
Epoch: 6 Valid Perplexity: 117.491
Epoch: 7 Learning rate: 0.125
0.004 perplexity: 71.127 speed: 26214 wps
0.104 perplexity: 51.810 speed: 25851 wps
0.204 perplexity: 56.527 speed: 25663 wps
0.304 perplexity: 54.455 speed: 25604 wps
0.404 perplexity: 53.589 speed: 25662 wps
0.504 perplexity: 52.800 speed: 25571 wps
0.604 perplexity: 51.106 speed: 25434 wps
0.703 perplexity: 50.437 speed: 25071 wps
0.803 perplexity: 49.724 speed: 23643 wps
0.903 perplexity: 48.143 speed: 22423 wps
Epoch: 7 Train Perplexity: 47.215
Epoch: 7 Valid Perplexity: 118.765
Epoch: 8 Learning rate: 0.062
0.004 perplexity: 66.810 speed: 16253 wps
0.104 perplexity: 48.499 speed: 15916 wps
0.204 perplexity: 52.962 speed: 16277 wps
0.304 perplexity: 50.978 speed: 18568 wps
0.404 perplexity: 50.164 speed: 20142 wps
0.504 perplexity: 49.417 speed: 21230 wps
0.604 perplexity: 47.804 speed: 22036 wps
0.703 perplexity: 47.150 speed: 22659 wps
0.803 perplexity: 46.447 speed: 23094 wps
0.903 perplexity: 44.931 speed: 23502 wps
Epoch: 8 Train Perplexity: 44.037
Epoch: 8 Valid Perplexity: 119.671
Epoch: 9 Learning rate: 0.031
0.004 perplexity: 64.284 speed: 27057 wps
0.104 perplexity: 46.772 speed: 26691 wps
0.204 perplexity: 51.088 speed: 26907 wps
0.304 perplexity: 49.142 speed: 26927 wps
0.404 perplexity: 48.340 speed: 27019 wps
0.504 perplexity: 47.630 speed: 27019 wps
0.604 perplexity: 46.063 speed: 26921 wps
0.703 perplexity: 45.425 speed: 26959 wps
0.803 perplexity: 44.725 speed: 26971 wps
0.903 perplexity: 43.243 speed: 26990 wps
Epoch: 9 Train Perplexity: 42.366
Epoch: 9 Valid Perplexity: 120.048
Epoch: 10 Learning rate: 0.016
0.004 perplexity: 62.870 speed: 27206 wps
0.104 perplexity: 45.829 speed: 27110 wps
0.204 perplexity: 50.066 speed: 27048 wps
0.304 perplexity: 48.141 speed: 27001 wps
0.404 perplexity: 47.335 speed: 27078 wps
0.504 perplexity: 46.642 speed: 27062 wps
0.604 perplexity: 45.110 speed: 27027 wps
0.703 perplexity: 44.487 speed: 27004 wps
0.803 perplexity: 43.787 speed: 27002 wps
0.903 perplexity: 42.321 speed: 27015 wps
Epoch: 10 Train Perplexity: 41.453
Epoch: 10 Valid Perplexity: 119.881
Epoch: 11 Learning rate: 0.008
0.004 perplexity: 62.027 speed: 27663 wps
0.104 perplexity: 45.272 speed: 27089 wps
0.204 perplexity: 49.488 speed: 27258 wps
0.304 perplexity: 47.583 speed: 27084 wps
0.404 perplexity: 46.775 speed: 26890 wps
0.504 perplexity: 46.089 speed: 26922 wps
0.604 perplexity: 44.578 speed: 26979 wps
0.703 perplexity: 43.963 speed: 26944 wps
0.803 perplexity: 43.266 speed: 26959 wps
0.903 perplexity: 41.811 speed: 26971 wps
Epoch: 11 Train Perplexity: 40.949
Epoch: 11 Valid Perplexity: 119.493
Epoch: 12 Learning rate: 0.004
0.004 perplexity: 61.500 speed: 27762 wps
0.104 perplexity: 44.923 speed: 27288 wps
0.204 perplexity: 49.146 speed: 27244 wps
0.304 perplexity: 47.265 speed: 27190 wps
0.404 perplexity: 46.461 speed: 27210 wps
0.504 perplexity: 45.780 speed: 27217 wps
0.604 perplexity: 44.283 speed: 27229 wps
0.703 perplexity: 43.673 speed: 27217 wps
0.803 perplexity: 42.979 speed: 27165 wps
0.903 perplexity: 41.531 speed: 27119 wps
Epoch: 12 Train Perplexity: 40.673
Epoch: 12 Valid Perplexity: 119.205
Epoch: 13 Learning rate: 0.002
0.004 perplexity: 61.206 speed: 27655 wps
0.104 perplexity: 44.724 speed: 26200 wps
0.204 perplexity: 48.949 speed: 26653 wps
0.304 perplexity: 47.087 speed: 26517 wps
0.404 perplexity: 46.287 speed: 26563 wps
0.504 perplexity: 45.611 speed: 26656 wps
0.604 perplexity: 44.122 speed: 26712 wps
0.703 perplexity: 43.516 speed: 26755 wps
0.803 perplexity: 42.824 speed: 26763 wps
0.903 perplexity: 41.381 speed: 26706 wps
Epoch: 13 Train Perplexity: 40.526
Epoch: 13 Valid Perplexity: 119.050
Test Perplexity: 114.649
